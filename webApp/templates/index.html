<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>CSC 394 - Software Projects</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="shortcut icon" href="../static/favicon.ico">

    <!-- CSS -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">                                           <!-- W3.CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">                                 <!-- Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <!-- Font Awesome 4 -->
    <link rel="stylesheet" href="../static/index.css">                                                                <!-- Our CSS -->

    <!-- JavaScript -->
    <script src="https://kit.fontawesome.com/f15e7c6ba2.js" crossorigin="anonymous"></script>                         <!-- Font Awesome 5 -->
    <script src="https://www.w3schools.com/lib/w3.js"></script>                                                       <!-- W3.JS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>                                               <!-- Chart.js -->
    <!-- Our JavaScript -->
    <script src="../static/index.js"></script>
    <script src="../static/graph.mjs" type="module"></script>

    <script type="module">
      import { graphInit, drawGraph } from '../static/graph.mjs';

      // for job recommendations
      document.getElementById('refresh').addEventListener('click', function(e) {
        var queryString = `/${document.getElementById('locationSelect').value}/jobs?`;

        var sliders = document.getElementsByClassName('slider');
        Array.from(sliders).forEach(elem => {
          var key = encodeURI(elem.previousElementSibling.innerText.replace('&', '').replace(/\s/g, ''));
          queryString += key + '=' + elem.value + '&';
        });

        // since there will be a trailing ampersand
        queryString = queryString.substring(0, queryString.length - 1);

        fetch(queryString)
          .then(response => response.json())
          .then(data     => updateJobs(data));
      });

      function updateJobs(data) {
        var table = document.getElementById('table');
        table.classList.remove("w3-hide");

        var len = table.rows.length;
        for (var i = 1; i < len; ++i)
          table.deleteRow(1);

        for (var obj of data) {
          var row = table.insertRow(-1);

          for (let [i, prop] of obj.entries()) {
            var cell = row.insertCell(-1);

            if (i !== obj.length - 1) // not the last element
              cell.textContent = prop;
            else {
              cell.innerHTML = '<i class="fas fa-external-link-alt"></i>';
              row.onclick = function(e) {
                window.open(prop);
              };
            }
          }
        }
      }

      // for Chart.js
      var keywords_source  = {{keywords_source|tojson}};
      var pays_source      = {{pays_source|tojson}};
      var locations_source = {{locations_source|tojson}};

      var keywords_skill  = {{keywords_skill|tojson}};
      var pays_skill      = {{pays_skill|tojson}};
      var locations_skill = {{locations_skill|tojson}};

      var chart1;
      var chart2;

      window.addEventListener('load', () => { chart1 = graphInit(chart1, 'chart1', keywords_source) });
      window.addEventListener('load', () => { chart2 = graphInit(chart2, 'chart2', keywords_skill)  });

      document.getElementById('chartSelect').addEventListener('change', function(e) {
        switch(e.target.value) {
          case 'keywords':
            drawGraph(chart1, keywords_source);
            drawGraph(chart2, keywords_skill);
            break;
          case 'pays':
            drawGraph(chart1, pays_source);
            drawGraph(chart2, pays_skill);
            break;
          case 'locations':
            drawGraph(chart1, locations_source);
            drawGraph(chart2, locations_skill);
            break;
        }
      });

      document.getElementById('switch-slider').addEventListener('click', (e) => {
        var c1 = document.getElementById('chart1');
        var c2 = document.getElementById('chart2');

        if (c1.style.display === 'none') {
          c1.style.display = 'block';
          c2.style.display = 'none';
        }
        else {
          c2.style.display = 'block';
          c1.style.display = 'none';
        }

        e.stopPropagation();
      });
    </script>
  </head>

  <body class="w3-black">

    <!-- Sidebar (hidden on phones) -->
    <nav class="w3-sidebar w3-bar-block w3-small w3-hide-small w3-center">
      <a href="#" class="w3-bar-item w3-button w3-padding-large w3-black">
        <i class="fa fa-home w3-xxlarge"></i>
        <p>HOME</p>
      </a>
      <a href="#skills" class="w3-bar-item w3-button w3-padding-large w3-hover-black">
        <i class="fa fa-check-square-o w3-xxlarge"></i>
        <p>SKILLS</p>
      </a>
      <a href="#data" class="w3-bar-item w3-button w3-padding-large w3-hover-black">
        <i class="fa fa-line-chart w3-xxlarge"></i>
        <p>DATA</p>
      </a>
      <a href="#about" class="w3-bar-item w3-button w3-padding-large w3-hover-black">
        <i class="fa fa-info w3-xxlarge"></i>
        <p>ABOUT</p>
      </a>
    </nav>

    <!-- Navbar (hidden on tablets & PCs) -->
    <div class="w3-top w3-hide-large w3-hide-medium">
      <div class="w3-bar w3-black w3-opacity w3-hover-opacity-off w3-center w3-small">
        <a href="#" class="w3-bar-item w3-button" style="width: 25% !important;">HOME</a>
        <a href="#skills" class="w3-bar-item w3-button" style="width: 25% !important;">SKILLS</a>
        <a href="#data" class="w3-bar-item w3-button" style="width: 25% !important;">DATA</a>
        <a href="#about" class="w3-bar-item w3-button" style="width: 25% !important;">ABOUT</a>
      </div>
    </div>

    <main class="w3-padding-large">

      <!-- Home -->
      <header class="w3-container w3-padding-32 w3-center w3-black" id="home">
        <h1 class="w3-jumbo">Software Projects.</h1>
        <p>A job aggregator for data scientists.</p>
      </header>

      <!-- Your Skills -->
      <div class="w3-content w3-justify w3-text-grey w3-padding-32" id="skills">
        <p class="w3-center w3-xlarge" style="margin-bottom: 0;">In order to best tailor our search results, tell us your experience.</p>
        <h3 class="w3-padding-16 w3-text-light-grey" style="position: relative; top: 2.5em">Technologies</h3>
        <h6 class="" style="position: relative; bottom: -15px; right: 2vw; text-align: right;">Years of<br>Experience</h6>

        <div id="slider-container" class="w3-margin-bottom">
          <p style="letter-spacing: 2px;">HTML, CSS, &amp; JavaScript</p>
          <input type="range" min="1" max="5" value="1" id="slider1" class="slider w3-show-inline-block w3-round-large" oninput="slider(this.value, 1)">
          <span class="badge w3-white" id="value1">{% raw %}{{value1}}{% endraw %}</span>

          <p style="letter-spacing: 2px;">Python</p>
          <input type="range" min="1" max="5" value="1" id="slider2" class="slider w3-show-inline-block w3-round-large" oninput="slider(this.value, 2)">
          <span class="badge w3-white" id="value2">{% raw %}{{value2}}{% endraw %}</span>

          <p style="letter-spacing: 2px;">R</p>
          <input type="range" min="1" max="5" value="1" id="slider3" class="slider w3-show-inline-block w3-round-large" oninput="slider(this.value, 3)">
          <span class="badge w3-white" id="value3">{% raw %}{{value3}}{% endraw %}</span>

          <p style="letter-spacing: 2px;">SQL</p>
          <input type="range" min="1" max="5" value="1" id="slider4" class="slider w3-show-inline-block w3-round-large" oninput="slider(this.value, 4)">
          <span class="badge w3-white" id="value4">{% raw %}{{value4}}{% endraw %}</span>
        </div>

        <h3 class="w3-padding-16 w3-text-light-grey w3-margin-top">Summary</h3>
        <div class="w3-row w3-center w3-padding-32 w3-section w3-light-grey" id="summary">
          <i id="minimize" class="fas fa-window-minimize w3-hover-opacity"></i>
          <div class="w3-quarter w3-section">
            <i class="fab fa-html5 w3-xxxlarge tooltip">
              <span class="tooltiptext w3-small" style="left: 150%; width: 50px;">HTML</span>
            </i>
            <i class="fab fa-css3-alt w3-xxxlarge tooltip">
              <span class="tooltiptext w3-small" style="left: 155%; width: 45px;">CSS</span>
            </i>
            <i class="fab fa-js-square w3-xxxlarge tooltip">
              <span class="tooltiptext w3-small" style="left: 105%; width: 75px;">JavaScript</span>
            </i><br>
            <p class="w3-large" id="proficiency1">{% raw %}{{proficiency1}}{% endraw %}</p>
          </div>

          <div class="w3-quarter w3-section">
            <i class="fab fa-python w3-xxxlarge tooltip">
              <span class="tooltiptext w3-small" style="left: 115%; width: 65px;">Python</span>
            </i><br>
            <p class="w3-large" id="proficiency2">{% raw %}{{proficiency2}}{% endraw %}</p>
          </div>

          <div class="w3-quarter w3-section">
            <i class="fab fa-r-project w3-xxxlarge tooltip">
              <span class="tooltiptext w3-small" style="left: 140%; width: 30px;">R</span>
            </i><br>
            <p class="w3-large" id="proficiency3">{% raw %}{{proficiency3}}{% endraw %}</p>
          </div>

          <div class="w3-quarter w3-section" style="margin-bottom: 50px !important;">
            <i class="fas fa-database w3-xxxlarge tooltip">
              <span class="tooltiptext w3-small" style="left: 140%; width: 45px; font-weight: normal;">SQL</span>
            </i><br>
            <p class="w3-large" id="proficiency4">{% raw %}{{proficiency4}}{% endraw %}</p>
          </div>

          <p class="w3-xlarge" id="role"><b>Expected role: </b>{% raw %}{{role}}{% endraw %}</p>
          <i id="lock" class="fas fa-lock-open w3-hover-opacity"></i>
        </div>

        <div class="w3-row w3-center w3-padding-32 w3-section w3-light-grey" style="width: 97%; position: relative;">
          <select id="locationSelect">
            <option value="AL">Alabama</option>
            <option value="AK">Alaska</option>
            <option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option>
            <option value="CA">California</option>
            <option value="CO">Colorado</option>
            <option value="CT">Connecticut</option>
            <option value="DE">Delaware</option>
            <option value="FL">Florida</option>
            <option value="GA">Georgia</option>
            <option value="HI">Hawaii</option>
            <option value="ID">Idaho</option>
            <option value="IL">Illinois</option>
            <option value="IN">Indiana</option>
            <option value="IA">Iowa</option>
            <option value="KS">Kansas</option>
            <option value="KY">Kentucky</option>
            <option value="LA">Louisiana</option>
            <option value="ME">Maine</option>
            <option value="MD">Maryland</option>
            <option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option>
            <option value="MN">Minnesota</option>
            <option value="MS">Mississippi</option>
            <option value="MO">Missouri</option>
            <option value="MT">Montana</option>
            <option value="NE">Nebraska</option>
            <option value="NV">Nevada</option>
            <option value="NH">New Hampshire</option>
            <option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option>
            <option value="NY">New York</option>
            <option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option>
            <option value="OH">Ohio</option>
            <option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option>
            <option value="PA">Pennsylvania</option>
            <option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option>
            <option value="SD">South Dakota</option>
            <option value="TN">Tennessee</option>
            <option value="TX">Texas</option>
            <option value="UT">Utah</option>
            <option value="VT">Vermont</option>
            <option value="VA">Virginia</option>
            <option value="WA">Washington</option>
            <option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option>
            <option value="WY">Wyoming</option>
          </select>
          <i id="refresh" class="fas fa-sync w3-hover-opacity"></i>
          <h3 style="margin-top: 0;">Job postings curated for you:</h3>
          <table class="w3-table w3-table-all w3-hoverable w3-hide" id="table">
            <tr>
              <th>position</th>
              <th>company</th>
              <th>location</th>
              <th></th>
            </tr>
          </table>
        </div>
      </div>

      <!-- Data -->
      <div class="w3-content w3-justify w3-text-grey w3-padding-32" id="data">
        <p class="w3-center w3-xlarge" style="margin-bottom:75px;">Analyzing <span style="color: #FFF;">{{num_jobs}}</span> data science positions from <a href="https://jobs.github.com/" target="_blank" class="links w3-hover-text-green">GitHub Jobs</a> & <a href="https://www.usajobs.gov/" target="_blank" class="links w3-hover-text-green">USAJobs</a>, here are our findings.</p>
        <select id="chartSelect">
          <option value="keywords">Skills</option>
          <option value="pays">Pay</option>
          <option value="locations">Locations</option>
        </select>
        <label id="switch" style="position: absolute; right: 12%;">
          <input type="checkbox">
          <span id="switch-slider"></span>
        </label>
       <canvas id="chart1"></canvas>
       <canvas id="chart2" style="display: none;"></canvas>
      </div>

      <!-- About -->
      <div class="w3-content w3-justify w3-text-grey w3-padding-32" id="about">
        <h3 class="w3-padding-16 w3-text-light-grey w3-margin-top">About</h3>
        <div class="w3-row w3-center w3-padding-16 w3-section w3-light-grey" style="width: 97%; position: relative;">
          <h3 class="w3-padding" style="margin-top: 0; text-align: left">DePaul University &mdash; 2020 Capstone</h3>
          <p class="w3-padding"><b>Project Description:</b> Create a dashboard tool which analyzes data science job openings, pulling data from live sources.</p>
          <div class="w3-section w3-row">
            <div class="w3-section w3-quarter">
              <h3 style="font-variant: small-caps"><b>tools</b></h3>
              <img src="../static/GitHub.png" title="GitHub"><br><img src="../static/PyCharm.png" title="PyCharm">
            </div>
            <div class="w3-section w3-quarter">
              <h3 style="font-variant: small-caps"><b>languages</b></h3>
              <img src="../static/Python.png" title="Python"><br><img src="../static/JavaScript.png" title="JavaScript">
            </div>
            <div class="w3-section w3-quarter">
              <h3 style="font-variant: small-caps"><b>front-end</b></h3>
              <img src="../static/W3Schools.png" title="W3.CSS & W3.JS" style="margin-top: 35px;"><br><img src="../static/Chart.js.png" title="Chart.js" style="margin-top: 40px;">
            </div>
            <div class="w3-section w3-quarter">
              <h3 style="font-variant: small-caps"><b>back-end</b></h3>
              <img src="../static/Flask.png" title="Flask"><br><img src="../static/AmazonDynamoDB.png" title="Amazon DynamoDB">
            </div>
          </div>
          <p class="w3-padding-32" style="padding-bottom: 0 !important;">Ameen Alrehn &middot; Mark Badel &middot; Brandon Hernandez &middot; Christian Kleinvehn &middot; Manases Leal &middot; Mason Scofield</p>
          <a href="https://github.com/Mason-Scofield/CSC-394-Data-Science-Jobs" target="_blank" class="w3-text-black w3-xlarge links w3-hover-text-green" style="display: inline-block; padding-bottom: 20px">Our Repository</a>
        </div>
      </div>

      <footer class="w3-content w3-padding-64 w3-text-grey w3-xlarge">
        <p class="w3-small">Favicon made by Pixel Perfect from <a href="https://www.flaticon.com/" target="_blank" class="w3-hover-text-green">www.flaticon.com</a>.</p>
      </footer>
    </main>
  </body>
</html>
